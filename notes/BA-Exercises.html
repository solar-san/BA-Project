<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="solar-san">

<title>Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="BA-Exercises_files/libs/clipboard/clipboard.min.js"></script>
<script src="BA-Exercises_files/libs/quarto-html/quarto.js"></script>
<script src="BA-Exercises_files/libs/quarto-html/popper.min.js"></script>
<script src="BA-Exercises_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="BA-Exercises_files/libs/quarto-html/anchor.min.js"></script>
<link href="BA-Exercises_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="BA-Exercises_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="BA-Exercises_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="BA-Exercises_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="BA-Exercises_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<meta name="author" content="solar-san">
<meta name="image" property="https://raw.githubusercontent.com/solar-san/BA-Project/main/docs/figures/BA-Project_header.png">
<meta name="description" content="Exercises">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&amp;family=Fira+Code&amp;display=swap" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#time-series-decomposition" id="toc-time-series-decomposition" class="nav-link active" data-scroll-target="#time-series-decomposition">Time Series Decomposition</a>
  <ul class="collapse">
  <li><a href="#reconstruct-the-calculations-needed-to-derive-the-components-in-the-multiplicative-decomposition-that-was-obtained-for-the-australian-gas-production." id="toc-reconstruct-the-calculations-needed-to-derive-the-components-in-the-multiplicative-decomposition-that-was-obtained-for-the-australian-gas-production." class="nav-link" data-scroll-target="#reconstruct-the-calculations-needed-to-derive-the-components-in-the-multiplicative-decomposition-that-was-obtained-for-the-australian-gas-production.">Reconstruct the calculations needed to derive the components in the multiplicative decomposition that was obtained for the Australian Gas Production.</a></li>
  <li><a href="#decompose-the-us-retail-sector-time-series.-use-an-additive-classical-decomposition.-plot-the-components-and-comment-on-possible-issues-in-the-resulting-decomposition." id="toc-decompose-the-us-retail-sector-time-series.-use-an-additive-classical-decomposition.-plot-the-components-and-comment-on-possible-issues-in-the-resulting-decomposition." class="nav-link" data-scroll-target="#decompose-the-us-retail-sector-time-series.-use-an-additive-classical-decomposition.-plot-the-components-and-comment-on-possible-issues-in-the-resulting-decomposition.">Decompose the US Retail sector time series. Use an additive classical decomposition. Plot the components and comment on possible issues in the resulting decomposition.</a></li>
  <li><a href="#derive-the-numerical-values-for-the-multiplicative-triple-exponential-smoothing-triple_mult-of-the-australian-beer-production-model-seen-above." id="toc-derive-the-numerical-values-for-the-multiplicative-triple-exponential-smoothing-triple_mult-of-the-australian-beer-production-model-seen-above." class="nav-link" data-scroll-target="#derive-the-numerical-values-for-the-multiplicative-triple-exponential-smoothing-triple_mult-of-the-australian-beer-production-model-seen-above.">Derive the numerical values for the multiplicative triple exponential smoothing (“Triple_Mult”) of the Australian beer production model seen above.</a></li>
  <li><a href="#focus-on-tobacco-production-in-australia-the-values-are-contained-in-the-aus_production-dataset-discuss-whether-a-single-double-or-triple-exponential-smoothing-would-be-more-appropriate-to-smooth-this-time-series.-compare-the-20-step-ahead-forecast-obtained-when-using-a-triple-exponential-smoothing-with-a-damped-and-non-damped-trend." id="toc-focus-on-tobacco-production-in-australia-the-values-are-contained-in-the-aus_production-dataset-discuss-whether-a-single-double-or-triple-exponential-smoothing-would-be-more-appropriate-to-smooth-this-time-series.-compare-the-20-step-ahead-forecast-obtained-when-using-a-triple-exponential-smoothing-with-a-damped-and-non-damped-trend." class="nav-link" data-scroll-target="#focus-on-tobacco-production-in-australia-the-values-are-contained-in-the-aus_production-dataset-discuss-whether-a-single-double-or-triple-exponential-smoothing-would-be-more-appropriate-to-smooth-this-time-series.-compare-the-20-step-ahead-forecast-obtained-when-using-a-triple-exponential-smoothing-with-a-damped-and-non-damped-trend.">Focus on Tobacco production in Australia: the values are contained in the <code>aus_production</code> dataset: discuss whether a single, double or triple exponential smoothing would be more appropriate to smooth this time series. Compare the 20-step ahead forecast obtained when using a triple exponential smoothing with a damped and non-damped trend.</a></li>
  <li><a href="#focus-on-the-global_economy-dataset-pick-a-country-say-france-and-produce-a-simple-exponential-smoothing-forecast-for-the-countrys-gdp.-discuss-whether-a-double-exponential-smoothing-or-triple-exponential-smoothing-would-be-suitable-to-use-for-smoothing-the-time-series." id="toc-focus-on-the-global_economy-dataset-pick-a-country-say-france-and-produce-a-simple-exponential-smoothing-forecast-for-the-countrys-gdp.-discuss-whether-a-double-exponential-smoothing-or-triple-exponential-smoothing-would-be-suitable-to-use-for-smoothing-the-time-series." class="nav-link" data-scroll-target="#focus-on-the-global_economy-dataset-pick-a-country-say-france-and-produce-a-simple-exponential-smoothing-forecast-for-the-countrys-gdp.-discuss-whether-a-double-exponential-smoothing-or-triple-exponential-smoothing-would-be-suitable-to-use-for-smoothing-the-time-series.">Focus on the <code>global_economy</code> dataset: pick a country (say France) and produce a simple exponential smoothing forecast for the country’s GDP. Discuss whether a double exponential smoothing or triple exponential smoothing would be suitable to use for smoothing the time series.</a></li>
  </ul></li>
  <li><a href="#quantile-regression" id="toc-quantile-regression" class="nav-link" data-scroll-target="#quantile-regression">Quantile Regression</a>
  <ul class="collapse">
  <li><a href="#obtain-the-dataset-bodyfat-in-which-the-weight-and-the-height-of-a-random-sample-of-255-men-are-stored" id="toc-obtain-the-dataset-bodyfat-in-which-the-weight-and-the-height-of-a-random-sample-of-255-men-are-stored" class="nav-link" data-scroll-target="#obtain-the-dataset-bodyfat-in-which-the-weight-and-the-height-of-a-random-sample-of-255-men-are-stored">Obtain the dataset <code>bodyfat</code> in which the weight and the height of a random sample of 255 men are stored:</a></li>
  <li><a href="#we-wish-to-construct-a-regression-model-in-which-the-weight-of-a-man-is-regressed-against-its-height.-use-a-quantile-regression-framework-to-answer-among-others-the-following-questions." id="toc-we-wish-to-construct-a-regression-model-in-which-the-weight-of-a-man-is-regressed-against-its-height.-use-a-quantile-regression-framework-to-answer-among-others-the-following-questions." class="nav-link" data-scroll-target="#we-wish-to-construct-a-regression-model-in-which-the-weight-of-a-man-is-regressed-against-its-height.-use-a-quantile-regression-framework-to-answer-among-others-the-following-questions.">We wish to construct a regression model in which the Weight of a man is regressed against its height. Use a quantile regression framework to answer (among others) the following questions.</a>
  <ul class="collapse">
  <li><a href="#what-is-the-effect-of-weight-on-height-does-this-appear-to-change-for-different-quantiles-compute-the-estimated-coefficients-and-provide-a-visual-display." id="toc-what-is-the-effect-of-weight-on-height-does-this-appear-to-change-for-different-quantiles-compute-the-estimated-coefficients-and-provide-a-visual-display." class="nav-link" data-scroll-target="#what-is-the-effect-of-weight-on-height-does-this-appear-to-change-for-different-quantiles-compute-the-estimated-coefficients-and-provide-a-visual-display.">What is the effect of Weight on Height: does this appear to change for different quantiles? Compute the estimated coefficients and provide a visual display.</a></li>
  <li><a href="#compute-the-95-confidence-interval-for-the-slope-parameter-of-the-median-regression.-also-indicate-whether-there-is-evidence-that-its-value-is-null." id="toc-compute-the-95-confidence-interval-for-the-slope-parameter-of-the-median-regression.-also-indicate-whether-there-is-evidence-that-its-value-is-null." class="nav-link" data-scroll-target="#compute-the-95-confidence-interval-for-the-slope-parameter-of-the-median-regression.-also-indicate-whether-there-is-evidence-that-its-value-is-null.">Compute the 95% confidence interval for the slope parameter of the median regression. Also, indicate whether there is evidence that its value is null.</a></li>
  <li><a href="#produce-some-plots-that-explore-whether-the-scale-or-shape-of-the-weight-distribution-changes-as-a-function-of-height." id="toc-produce-some-plots-that-explore-whether-the-scale-or-shape-of-the-weight-distribution-changes-as-a-function-of-height." class="nav-link" data-scroll-target="#produce-some-plots-that-explore-whether-the-scale-or-shape-of-the-weight-distribution-changes-as-a-function-of-height.">Produce some plots that explore whether the scale or shape of the Weight distribution changes as a function of Height.</a></li>
  <li><a href="#is-there-strong-evidence-against-the-distribution-of-weight-being-different-for-different-levels-of-height" id="toc-is-there-strong-evidence-against-the-distribution-of-weight-being-different-for-different-levels-of-height" class="nav-link" data-scroll-target="#is-there-strong-evidence-against-the-distribution-of-weight-being-different-for-different-levels-of-height">Is there strong evidence against the distribution of Weight being different for different levels of Height?</a></li>
  </ul></li>
  <li><a href="#carry-out-a-single-predictor-quantile-regression-analysis-for-the-munich-rents-dataset-investigating-the-effect-of-area-on-rent-and-on-rentsq.-answer-questions-similar-to-those-presented-in-exercise-1." id="toc-carry-out-a-single-predictor-quantile-regression-analysis-for-the-munich-rents-dataset-investigating-the-effect-of-area-on-rent-and-on-rentsq.-answer-questions-similar-to-those-presented-in-exercise-1." class="nav-link" data-scroll-target="#carry-out-a-single-predictor-quantile-regression-analysis-for-the-munich-rents-dataset-investigating-the-effect-of-area-on-rent-and-on-rentsq.-answer-questions-similar-to-those-presented-in-exercise-1.">Carry out a single predictor quantile regression analysis for the Munich rents dataset investigating the effect of <code>area</code> on <code>rent</code> and on <code>rentsq</code>. Answer questions similar to those presented in Exercise 1.</a></li>
  <li><a href="#use-the-incomeex-dataset.-what-is-the-effect-of-age-on-income" id="toc-use-the-incomeex-dataset.-what-is-the-effect-of-age-on-income" class="nav-link" data-scroll-target="#use-the-incomeex-dataset.-what-is-the-effect-of-age-on-income">Use the <code>incomeEx</code> dataset. What is the effect of Age on Income?</a></li>
  <li><a href="#is-this-the-same-for-all-quantiles-of-the-distribution" id="toc-is-this-the-same-for-all-quantiles-of-the-distribution" class="nav-link" data-scroll-target="#is-this-the-same-for-all-quantiles-of-the-distribution">Is this the same for all quantiles of the distribution?</a></li>
  <li><a href="#construct-models-in-which-the-relationship-is-allowed-to-be-different-depending-on-the-race-and-education-level-of-the-household-head.-provide-a-graphical-display-that-presents-the-estimated-models.-is-there-enough-evidence-to-indicate-that-the-effect-of-age-on-income-is-different-for-different-raceseducation-levels-specify-the-statistical-test-that-would-be-carried-out." id="toc-construct-models-in-which-the-relationship-is-allowed-to-be-different-depending-on-the-race-and-education-level-of-the-household-head.-provide-a-graphical-display-that-presents-the-estimated-models.-is-there-enough-evidence-to-indicate-that-the-effect-of-age-on-income-is-different-for-different-raceseducation-levels-specify-the-statistical-test-that-would-be-carried-out." class="nav-link" data-scroll-target="#construct-models-in-which-the-relationship-is-allowed-to-be-different-depending-on-the-race-and-education-level-of-the-household-head.-provide-a-graphical-display-that-presents-the-estimated-models.-is-there-enough-evidence-to-indicate-that-the-effect-of-age-on-income-is-different-for-different-raceseducation-levels-specify-the-statistical-test-that-would-be-carried-out.">Construct models in which the relationship is allowed to be different depending on the race and education level of the household head. Provide a graphical display that presents the estimated models. Is there enough evidence to indicate that the effect of Age on Income is different for different races/education levels? Specify the statistical test that would be carried out.</a></li>
  </ul></li>
  <li><a href="#bootstrap" id="toc-bootstrap" class="nav-link" data-scroll-target="#bootstrap">Bootstrap</a>
  <ul class="collapse">
  <li><a href="#for-the-munich-data-compute-confidence-intervals-of-the-mean-rental-price-for-locations-without-central-heating-both-using-theory-and-a-bootstrap-based-approach." id="toc-for-the-munich-data-compute-confidence-intervals-of-the-mean-rental-price-for-locations-without-central-heating-both-using-theory-and-a-bootstrap-based-approach." class="nav-link" data-scroll-target="#for-the-munich-data-compute-confidence-intervals-of-the-mean-rental-price-for-locations-without-central-heating-both-using-theory-and-a-bootstrap-based-approach.">For the Munich data compute confidence intervals of the mean rental price for locations without central heating both using theory and a bootstrap-based approach.</a></li>
  <li><a href="#take-the-engel-data.-estimate-a-quantile-regression-model-for-tau-c0.10.50.9.-derive-bootstrap-based-sampling-distributions-for-the-regression-model-parameters.-compare-the-estimated-standard-error-derived-for-your-bootstrap-distribution-to-the-ones-obtained-using-summary-from-the-quantreg-package." id="toc-take-the-engel-data.-estimate-a-quantile-regression-model-for-tau-c0.10.50.9.-derive-bootstrap-based-sampling-distributions-for-the-regression-model-parameters.-compare-the-estimated-standard-error-derived-for-your-bootstrap-distribution-to-the-ones-obtained-using-summary-from-the-quantreg-package." class="nav-link" data-scroll-target="#take-the-engel-data.-estimate-a-quantile-regression-model-for-tau-c0.10.50.9.-derive-bootstrap-based-sampling-distributions-for-the-regression-model-parameters.-compare-the-estimated-standard-error-derived-for-your-bootstrap-distribution-to-the-ones-obtained-using-summary-from-the-quantreg-package.">Take the <code>engel</code> data. Estimate a quantile regression model for <span class="math inline">\tau = c(0.1,0.5,0.9)</span>. Derive bootstrap-based sampling distributions for the regression model parameters. Compare the estimated standard error derived for your bootstrap distribution to the ones obtained using <code>summary</code> from the <code>quantreg</code> package.</a></li>
  <li><a href="#take-the-engel-data.-make-a-plot-that-shows-the-point-estimate-and-bootstrap-based-intervals-for-the-slope-of-different-quantile-regression-models-for-values-of-tau-seq0.1-0.9-by-0.05." id="toc-take-the-engel-data.-make-a-plot-that-shows-the-point-estimate-and-bootstrap-based-intervals-for-the-slope-of-different-quantile-regression-models-for-values-of-tau-seq0.1-0.9-by-0.05." class="nav-link" data-scroll-target="#take-the-engel-data.-make-a-plot-that-shows-the-point-estimate-and-bootstrap-based-intervals-for-the-slope-of-different-quantile-regression-models-for-values-of-tau-seq0.1-0.9-by-0.05.">Take the <code>engel</code> data. Make a plot that shows the point estimate and bootstrap-based intervals for the slope of different quantile regression models for values of <span class="math inline">\tau</span> = <code>seq(0.1, 0.9, by = 0.05)</code>.</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exercises</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>solar-san </p>
          </div>
  </div>
    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 7, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<p><img src="https://raw.githubusercontent.com/solar-san/BA-Project/main/docs/figures/BA-Project_header.png" class="img-fluid"></p>
<div class="cell">

</div>
<section id="time-series-decomposition" class="level1">
<h1>Time Series Decomposition</h1>
<section id="reconstruct-the-calculations-needed-to-derive-the-components-in-the-multiplicative-decomposition-that-was-obtained-for-the-australian-gas-production." class="level2">
<h2 class="anchored" data-anchor-id="reconstruct-the-calculations-needed-to-derive-the-components-in-the-multiplicative-decomposition-that-was-obtained-for-the-australian-gas-production.">Reconstruct the calculations needed to derive the components in the multiplicative decomposition that was obtained for the Australian Gas Production.</h2>
<p>The multiplicative decomposition obtained was a <em>classical multiplicative decomposition</em>:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>aus_production <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">class_mult =</span> <span class="fu">classical_decomposition</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      Gas, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"m"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Classical Decomposition of Australian gas production"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The model behind the multiplicative decomposition is the following:</p>
<p><span class="math display">
Y_t = T_t \times S_t \times R_t
</span></p>
<p>First, an appropriate <em>exponential smoothing</em> has been applied to the series.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>aus_production <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_lag</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    Gas,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"point"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Lag plot for Australian gas production'</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>We can observe a <span class="math inline">k=4</span> seasonal pattern. This can be confirmed by an ACF plot:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>aus_production <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(Gas) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  autoplot <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"ACF plot for Australian gas production"</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>If no arguments are passed, a <em>symmetric</em> window with equal weights is used to obtain the <span class="math inline">T_t</span> (trend component). The following step is to de-trend the series:</p>
<p><span class="math display">
\frac{y_t} {T_t}
</span></p>
<p>The seasonal component is computed by taking the average of all the de-trended values for each for that season. The decomposition is multiplicative: hence, the individual seasonal terms are adjusted to ensure that they sum up to <span class="math inline">m</span>. The remainder component is then computed by dividing by the trend and seasonal components:</p>
<p><span class="math display">
R_t = \frac{y_t}{ S_t  T_t}
</span></p>
<p>To conclude, de-seasonalize the series:</p>
<p><span class="math display">
\frac{y_t}{S_t}
</span> ## Compute a 5-MA and 9-MA for the oil prices in the <code>prices</code> dataset and overlay them to the original data ensuring that suitable labels are used to identify the different fits</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>prices <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'5-MA'</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>      oil,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      mean,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">2</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">.after =</span> <span class="dv">2</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">complete =</span> <span class="cn">TRUE</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'9-MA'</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      oil,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      mean,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">4</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">.after =</span> <span class="dv">4</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">complete =</span> <span class="cn">TRUE</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> year</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> oil</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray90"</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">5-MA</span><span class="st">`</span>,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"5-MA"</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">9-MA</span><span class="st">`</span>,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"9-MA"</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  custom_color <span class="sc">+</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Moving Averages of oil prices'</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="decompose-the-us-retail-sector-time-series.-use-an-additive-classical-decomposition.-plot-the-components-and-comment-on-possible-issues-in-the-resulting-decomposition." class="level2">
<h2 class="anchored" data-anchor-id="decompose-the-us-retail-sector-time-series.-use-an-additive-classical-decomposition.-plot-the-components-and-comment-on-possible-issues-in-the-resulting-decomposition.">Decompose the US Retail sector time series. Use an additive classical decomposition. Plot the components and comment on possible issues in the resulting decomposition.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>us_retail <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  us_employment <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>      Title <span class="sc">==</span> <span class="st">"Retail Trade"</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">year</span>(Month) <span class="sc">&gt;=</span> <span class="dv">1980</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>      ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>us_retail <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">classical_decomposition</span>(Employed)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  autoplot <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Classical Decomposition of employed in US retail'</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The main assumption in this case is that the seasonal term is assumed as constant: the remainder term is a clear indication of eteroskedasticity and this assumption needs to be reconsidered.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>us_retail <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Employed) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Employment in the US retail sector"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>From the original series, we can see that the magnitude of the seasonal variation depends on the level of the series; therefore, a multiplicative decomposition might be more appropriate.</p>
</section>
<section id="derive-the-numerical-values-for-the-multiplicative-triple-exponential-smoothing-triple_mult-of-the-australian-beer-production-model-seen-above." class="level2">
<h2 class="anchored" data-anchor-id="derive-the-numerical-values-for-the-multiplicative-triple-exponential-smoothing-triple_mult-of-the-australian-beer-production-model-seen-above.">Derive the numerical values for the multiplicative triple exponential smoothing (“Triple_Mult”) of the Australian beer production model seen above.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>aus_beer <span class="ot">&lt;-</span> aus_production <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Beer)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> aus_beer <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Triple_Mult =</span> <span class="fu">ETS</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      Beer <span class="sc">~</span> <span class="fu">trend</span>(<span class="st">"A"</span>)<span class="sc">+</span><span class="fu">season</span>(<span class="st">"M"</span>)<span class="sc">+</span><span class="fu">error</span>(<span class="st">"M"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    Quarter, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    .fitted</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Quarter</th>
<th style="text-align: right;">.fitted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2000 Q1</td>
<td style="text-align: right;">434.4008</td>
</tr>
<tr class="even">
<td style="text-align: left;">2000 Q2</td>
<td style="text-align: right;">396.7817</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2000 Q3</td>
<td style="text-align: right;">417.7119</td>
</tr>
<tr class="even">
<td style="text-align: left;">2000 Q4</td>
<td style="text-align: right;">494.6398</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2001 Q1</td>
<td style="text-align: right;">434.7939</td>
</tr>
<tr class="even">
<td style="text-align: left;">2001 Q2</td>
<td style="text-align: right;">399.8998</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="focus-on-tobacco-production-in-australia-the-values-are-contained-in-the-aus_production-dataset-discuss-whether-a-single-double-or-triple-exponential-smoothing-would-be-more-appropriate-to-smooth-this-time-series.-compare-the-20-step-ahead-forecast-obtained-when-using-a-triple-exponential-smoothing-with-a-damped-and-non-damped-trend." class="level2">
<h2 class="anchored" data-anchor-id="focus-on-tobacco-production-in-australia-the-values-are-contained-in-the-aus_production-dataset-discuss-whether-a-single-double-or-triple-exponential-smoothing-would-be-more-appropriate-to-smooth-this-time-series.-compare-the-20-step-ahead-forecast-obtained-when-using-a-triple-exponential-smoothing-with-a-damped-and-non-damped-trend.">Focus on Tobacco production in Australia: the values are contained in the <code>aus_production</code> dataset: discuss whether a single, double or triple exponential smoothing would be more appropriate to smooth this time series. Compare the 20-step ahead forecast obtained when using a triple exponential smoothing with a damped and non-damped trend.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>aus_tobacco <span class="ot">&lt;-</span> aus_production <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Tobacco) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>aus_tobacco <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Tobacco)  <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Australian tobacco production"</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The dataset shows a strong seasonal and trend-cycle component: hence, simple exponential smoothing is <em>not</em> as appropriate, as double exponential smoothing, because they cannot deal with the seasonal component. <em>Triple Exponential Smoothing</em> (Holt-Winter’s method) is the preferred choice in this context.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> aus_tobacco <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">linear =</span> <span class="fu">ETS</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>      Tobacco <span class="sc">~</span> <span class="fu">error</span>(<span class="st">'A'</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">'A'</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">'A'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">damped =</span> <span class="fu">ETS</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      Tobacco <span class="sc">~</span> <span class="fu">error</span>(<span class="st">'A'</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">'A'</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">'Ad'</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">h =</span> <span class="dv">20</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>fc <span class="sc">%&gt;%</span> </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    aus_tobacco,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="cn">NULL</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  custom_color <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Damped and linear ETS forecasts </span><span class="sc">\n</span><span class="st"> for the Australian tobacco production"</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="focus-on-the-global_economy-dataset-pick-a-country-say-france-and-produce-a-simple-exponential-smoothing-forecast-for-the-countrys-gdp.-discuss-whether-a-double-exponential-smoothing-or-triple-exponential-smoothing-would-be-suitable-to-use-for-smoothing-the-time-series." class="level2">
<h2 class="anchored" data-anchor-id="focus-on-the-global_economy-dataset-pick-a-country-say-france-and-produce-a-simple-exponential-smoothing-forecast-for-the-countrys-gdp.-discuss-whether-a-double-exponential-smoothing-or-triple-exponential-smoothing-would-be-suitable-to-use-for-smoothing-the-time-series.">Focus on the <code>global_economy</code> dataset: pick a country (say France) and produce a simple exponential smoothing forecast for the country’s GDP. Discuss whether a double exponential smoothing or triple exponential smoothing would be suitable to use for smoothing the time series.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> global_economy <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    Country <span class="sc">==</span> <span class="st">'Japan'</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ETS</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>      GDP <span class="sc">~</span> <span class="fu">error</span>(<span class="st">'A'</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">'N'</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">'N'</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">h =</span> <span class="dv">10</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fc <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    global_economy <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    Country <span class="sc">==</span> <span class="st">'Japan'</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"indianred4"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simple exponential smoothing forecast for Japan GDP"</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>A double exponential smoothing would be more effective, as we have a trended series:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> global_economy <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    Country <span class="sc">==</span> <span class="st">'Japan'</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ETS</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      GDP <span class="sc">~</span> <span class="fu">error</span>(<span class="st">'A'</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">'N'</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">'A'</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">h =</span> <span class="dv">10</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fc <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    global_economy <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    Country <span class="sc">==</span> <span class="st">'Japan'</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="cn">NULL</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"indianred4"</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> .fitted,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"Smoothed Series"</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>      augment</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Double exponential smoothing forecast for Japan GDP"</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="quantile-regression" class="level1 page-columns page-full">
<h1>Quantile Regression</h1>
<section id="obtain-the-dataset-bodyfat-in-which-the-weight-and-the-height-of-a-random-sample-of-255-men-are-stored" class="level2">
<h2 class="anchored" data-anchor-id="obtain-the-dataset-bodyfat-in-which-the-weight-and-the-height-of-a-random-sample-of-255-men-are-stored">Obtain the dataset <code>bodyfat</code> in which the weight and the height of a random sample of 255 men are stored:</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>urlLocation <span class="ot">&lt;-</span> <span class="st">"https://dasl.datadescription.com/download/data/3079"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>bodyfat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(urlLocation, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>bodyfat <span class="ot">&lt;-</span> bodyfat[,<span class="fu">c</span>(<span class="st">"Weight"</span>,<span class="st">"Height"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bodyfat <span class="sc">%&gt;%</span> str</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   250 obs. of  2 variables:
 $ Weight: num  154 173 154 185 184 ...
 $ Height: num  67.8 72.2 66.2 72.2 71.2 ...</code></pre>
</div>
</div>
</section>
<section id="we-wish-to-construct-a-regression-model-in-which-the-weight-of-a-man-is-regressed-against-its-height.-use-a-quantile-regression-framework-to-answer-among-others-the-following-questions." class="level2">
<h2 class="anchored" data-anchor-id="we-wish-to-construct-a-regression-model-in-which-the-weight-of-a-man-is-regressed-against-its-height.-use-a-quantile-regression-framework-to-answer-among-others-the-following-questions.">We wish to construct a regression model in which the Weight of a man is regressed against its height. Use a quantile regression framework to answer (among others) the following questions.</h2>
<section id="what-is-the-effect-of-weight-on-height-does-this-appear-to-change-for-different-quantiles-compute-the-estimated-coefficients-and-provide-a-visual-display." class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-effect-of-weight-on-height-does-this-appear-to-change-for-different-quantiles-compute-the-estimated-coefficients-and-provide-a-visual-display.">What is the effect of Weight on Height: does this appear to change for different quantiles? Compute the estimated coefficients and provide a visual display.</h3>
<p>Fitting the QRM model:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bodyfat_qrfit <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  Weight <span class="sc">~</span> Height,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> bodyfat,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fu">c</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">1</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">25</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">5</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">75</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">9</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>bodyfat_qrfit <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
<th style="text-align: right;">tau</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-207.613636</td>
<td style="text-align: right;">-565.203220</td>
<td style="text-align: right;">-144.514235</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Height</td>
<td style="text-align: right;">5.090909</td>
<td style="text-align: right;">3.871552</td>
<td style="text-align: right;">7.228789</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-248.333333</td>
<td style="text-align: right;">-344.188206</td>
<td style="text-align: right;">-116.792689</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Height</td>
<td style="text-align: right;">5.833333</td>
<td style="text-align: right;">4.032503</td>
<td style="text-align: right;">7.036587</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-236.366667</td>
<td style="text-align: right;">-315.501798</td>
<td style="text-align: right;">-110.936095</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Height</td>
<td style="text-align: right;">5.866667</td>
<td style="text-align: right;">3.934430</td>
<td style="text-align: right;">6.957678</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-210.692308</td>
<td style="text-align: right;">-329.142751</td>
<td style="text-align: right;">-104.019677</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: left;">Height</td>
<td style="text-align: right;">5.730769</td>
<td style="text-align: right;">4.276160</td>
<td style="text-align: right;">7.406917</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-181.250000</td>
<td style="text-align: right;">-297.982007</td>
<td style="text-align: right;">8.188658</td>
<td style="text-align: right;">0.90</td>
</tr>
<tr class="even">
<td style="text-align: left;">Height</td>
<td style="text-align: right;">5.575758</td>
<td style="text-align: right;">2.959233</td>
<td style="text-align: right;">7.197916</td>
<td style="text-align: right;">0.90</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bodyfat_qrfit <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">R =</span> <span class="dv">1201</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: rq(formula = Weight ~ Height, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = bodyfat)

tau: [1] 0.1

Coefficients:
            Value      Std. Error t value    Pr(&gt;|t|)  
(Intercept) -207.61364   37.24805   -5.57381    0.00000
Height         5.09091    0.53337    9.54475    0.00000

Call: rq(formula = Weight ~ Height, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = bodyfat)

tau: [1] 0.25

Coefficients:
            Value      Std. Error t value    Pr(&gt;|t|)  
(Intercept) -248.33333   46.74312   -5.31273    0.00000
Height         5.83333    0.66110    8.82374    0.00000

Call: rq(formula = Weight ~ Height, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = bodyfat)

tau: [1] 0.5

Coefficients:
            Value      Std. Error t value    Pr(&gt;|t|)  
(Intercept) -236.36667   50.73028   -4.65928    0.00001
Height         5.86667    0.72698    8.06994    0.00000

Call: rq(formula = Weight ~ Height, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = bodyfat)

tau: [1] 0.75

Coefficients:
            Value      Std. Error t value    Pr(&gt;|t|)  
(Intercept) -210.69231   67.20458   -3.13509    0.00193
Height         5.73077    0.95477    6.00222    0.00000

Call: rq(formula = Weight ~ Height, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = bodyfat)

tau: [1] 0.9

Coefficients:
            Value      Std. Error t value    Pr(&gt;|t|)  
(Intercept) -181.25000   90.44105   -2.00407    0.04615
Height         5.57576    1.28076    4.35349    0.00002</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  bodyfat,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> Height,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> Weight</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> <span class="fu">c</span>(</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>      .<span class="dv">1</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>      .<span class="dv">25</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>      .<span class="dv">5</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>      .<span class="dv">75</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>      .<span class="dv">9</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Smoothing formula not specified. Using: y ~ x</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>bodyfat_coeff <span class="ot">&lt;-</span> bodyfat_qrfit <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coefficients</span>()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span>  <span class="fu">c</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">1</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">25</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">5</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">75</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">9</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> bodyfat_coeff[<span class="dv">2</span>,]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Weight ~ Height QRM coefficients"</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Quantiles"</span>,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Slopes"</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>While indeed the effect is different for different quantiles, the slops are not different in a statistically significant way.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(bodyfat_qrfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Quantile Regression Analysis of Deviance Table

Model: Weight ~ Height
Joint Test of Equality of Slopes: tau in {  0.1 0.25 0.5 0.75 0.9  }

  Df Resid Df F value Pr(&gt;F)
1  4     1246    0.41 0.8015</code></pre>
</div>
</div>
<p>The main variation among the quantiles is related to the <em>intercept</em>, which is clearly varying. Up until the 25% quantile, the average effect of height on weight is decreasing; this relationship is inverted from the 25% to the 90% quantile, in which higher heights are associated on average with higher weights.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span>  <span class="fu">c</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">1</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">25</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">5</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">75</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">9</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> bodyfat_coeff[<span class="dv">1</span>,]</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Weight ~ Height QRM coefficients"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Quantiles"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Intercepts"</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="compute-the-95-confidence-interval-for-the-slope-parameter-of-the-median-regression.-also-indicate-whether-there-is-evidence-that-its-value-is-null." class="level3">
<h3 class="anchored" data-anchor-id="compute-the-95-confidence-interval-for-the-slope-parameter-of-the-median-regression.-also-indicate-whether-there-is-evidence-that-its-value-is-null.">Compute the 95% confidence interval for the slope parameter of the median regression. Also, indicate whether there is evidence that its value is null.</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>bodyfat_medianfit <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  Weight <span class="sc">~</span> Height,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> bodyfat</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bodyfat_medianfit <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="st">"boot"</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: rq(formula = Weight ~ Height, data = bodyfat)

tau: [1] 0.5

Coefficients:
            Value      Std. Error t value    Pr(&gt;|t|)  
(Intercept) -236.36667   49.84738   -4.74181    0.00000
Height         5.86667    0.71471    8.20845    0.00000</code></pre>
</div>
</div>
<p>The p-value of the slope coefficient significance test is <span class="math inline">\approx</span> 0; the observed data points against the null hypothesis, hence the slope parameter is, with a given confidence, different than zero.</p>
<p>We will use bootstrapped coefficients to compute a 95% confidence interval for the slope:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>qr_boot <span class="ot">&lt;-</span> <span class="fu">boot.rq</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">cbind</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    bodyfat<span class="sc">$</span>Height</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> bodyfat<span class="sc">$</span>Weight,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fl">0.5</span>, </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> <span class="dv">2000</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef =</span> bodyfat_coeff</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">apply</span>(qr_boot<span class="sc">$</span>B, <span class="dv">2</span>, quantile, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)))[<span class="dv">2</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    2.5%    97.5% 
4.071429 7.000000 </code></pre>
</div>
</div>
</section>
<section id="produce-some-plots-that-explore-whether-the-scale-or-shape-of-the-weight-distribution-changes-as-a-function-of-height." class="level3">
<h3 class="anchored" data-anchor-id="produce-some-plots-that-explore-whether-the-scale-or-shape-of-the-weight-distribution-changes-as-a-function-of-height.">Produce some plots that explore whether the scale or shape of the Weight distribution changes as a function of Height.</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>qs <span class="ot">&lt;-</span> bodyfat_qrfit <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">expand_grid</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">Height =</span> <span class="fu">seq</span>(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">64.00</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">77.75</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from  =</span>.tau, </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> .fitted</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">QSC025 =</span> <span class="st">`</span><span class="at">0.75</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.25</span><span class="st">`</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">QSK010 =</span> (<span class="st">`</span><span class="at">0.9</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.5</span><span class="st">`</span>)<span class="sc">/</span>(<span class="st">`</span><span class="at">0.5</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.1</span><span class="st">`</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qs) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>      Height, </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>      QSC025</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The spread of the weight distribution is slightly decreasing as height decreases.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qs) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>      Height, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>      QSK010</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>A value greater than zero indicates right-skewness and a value less than 0 indicates left-skewness: in this case, we have a slightly right-skewed weight distribution that becomes more symmetrical as the height increases.</p>
</section>
<section id="is-there-strong-evidence-against-the-distribution-of-weight-being-different-for-different-levels-of-height" class="level3">
<h3 class="anchored" data-anchor-id="is-there-strong-evidence-against-the-distribution-of-weight-being-different-for-different-levels-of-height">Is there strong evidence against the distribution of Weight being different for different levels of Height?</h3>
<p>Based on the available data, the result is ambiguous; while indeed the position of the distribution changes with height, as it is more common for taller people to weigh more, the slope of the effect of the regressor on the regressand and the overall shape and scale of the distribution, as its skewness, is not heavily impacted (if not impacted at all); hence, only weak evidence in favor of this difference can be derived from the observed data.</p>
</section>
</section>
<section id="carry-out-a-single-predictor-quantile-regression-analysis-for-the-munich-rents-dataset-investigating-the-effect-of-area-on-rent-and-on-rentsq.-answer-questions-similar-to-those-presented-in-exercise-1." class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="carry-out-a-single-predictor-quantile-regression-analysis-for-the-munich-rents-dataset-investigating-the-effect-of-area-on-rent-and-on-rentsq.-answer-questions-similar-to-those-presented-in-exercise-1.">Carry out a single predictor quantile regression analysis for the Munich rents dataset investigating the effect of <code>area</code> on <code>rent</code> and on <code>rentsq</code>. Answer questions similar to those presented in Exercise 1.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>rents_sel <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_table</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pathmaker</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/rent99.raw"</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rent =</span> <span class="fu">col_double</span>(),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rentsqm =</span> <span class="fu">col_double</span>(),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">col_double</span>(),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">yearc =</span> <span class="fu">col_double</span>(),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">location =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bath =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">kitchen =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cheating =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">district =</span> <span class="fu">col_factor</span>()</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(area, rent, rentsqm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>rents_sel <span class="sc">%&gt;%</span> summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      area             rent            rentsqm       
 Min.   : 20.00   Min.   :  40.51   Min.   : 0.4158  
 1st Qu.: 51.00   1st Qu.: 322.03   1st Qu.: 5.2610  
 Median : 65.00   Median : 426.97   Median : 6.9802  
 Mean   : 67.37   Mean   : 459.44   Mean   : 7.1113  
 3rd Qu.: 81.00   3rd Qu.: 559.36   3rd Qu.: 8.8408  
 Max.   :160.00   Max.   :1843.38   Max.   :17.7216  </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|column: page</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> rents_sel <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>      area</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"indianred"</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> rents_sel <span class="sc">%&gt;%</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>      rent</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"springgreen4"</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> rents_sel <span class="sc">%&gt;%</span> </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>      rentsqm</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"darkslategray4"</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rent_qr <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  rent <span class="sc">~</span> area,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> tau_sel,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> rents_sel</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>rentsqm_qr <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  rentsqm <span class="sc">~</span> area,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> tau_sel,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> rents_sel</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rent_qr <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="st">'boot'</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: rq(formula = rent ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.1

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept) 100.40560  13.39517    7.49566   0.00000
area          2.55789   0.21887   11.68704   0.00000

Call: rq(formula = rent ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.25

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept) 143.23414   8.78803   16.29877   0.00000
area          3.10940   0.15546   20.00133   0.00000

Call: rq(formula = rent ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.5

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept) 161.35189   8.85820   18.21497   0.00000
area          4.27932   0.16903   25.31688   0.00000

Call: rq(formula = rent ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.75

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept) 137.46909   9.66778   14.21930   0.00000
area          6.36802   0.15809   40.27977   0.00000

Call: rq(formula = rent ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.9

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept) 126.91388  12.51080   10.14435   0.00000
area          7.89612   0.24470   32.26835   0.00000</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>rentsqm_qr <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="st">'boot'</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: rq(formula = rentsqm ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.1

Coefficients:
            Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)  5.73704  0.26243   21.86137  0.00000
area        -0.02257  0.00358   -6.31020  0.00000

Call: rq(formula = rentsqm ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.25

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)   7.77276   0.16088   48.31406   0.00000
area         -0.03328   0.00215  -15.45352   0.00000

Call: rq(formula = rentsqm ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.5

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)   9.79605   0.17320   56.56041   0.00000
area         -0.04148   0.00222  -18.71427   0.00000

Call: rq(formula = rentsqm ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.75

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)  11.17064   0.18521   60.31183   0.00000
area         -0.03677   0.00273  -13.45691   0.00000

Call: rq(formula = rentsqm ~ area, tau = tau_sel, data = rents_sel)

tau: [1] 0.9

Coefficients:
            Value    Std. Error t value  Pr(&gt;|t|)
(Intercept) 12.39842  0.21294   58.22590  0.00000
area        -0.03419  0.00342   -9.99403  0.00000</code></pre>
</div>
</div>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> rents_sel <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> area,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> rent</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">'grey30'</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">6</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> tau_sel,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkorange"</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Rent ~ Area'</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> rents_sel <span class="sc">%&gt;%</span> </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> area,</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> rentsqm</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">'grey30'</span>,</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">6</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> tau_sel,</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"limegreen"</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Rentsqm ~ Area'</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Smoothing formula not specified. Using: y ~ x
Smoothing formula not specified. Using: y ~ x</code></pre>
</div>
<div class="cell-output-display column-page">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>rent_qr_coef <span class="ot">&lt;-</span> rent_qr <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>rentsqm_qr_coef <span class="ot">&lt;-</span> rentsqm_qr <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|column: page</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> tau_sel,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> rent_qr_coef[<span class="dv">2</span>, ]</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Rent ~ Area'</span>,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Quantiles'</span>,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Slope'</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> tau_sel,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> rentsqm_qr_coef[<span class="dv">2</span>, ]</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Rentsqm ~ Area'</span>,</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Quantiles'</span>,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Slope'</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="st">'Slopes coefficients for different quantiles'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|column: page</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> tau_sel,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> rent_qr_coef[<span class="dv">1</span>, ]</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Rent ~ Area'</span>,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Quantiles'</span>,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Intercepts'</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> tau_sel,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> rentsqm_qr_coef[<span class="dv">1</span>, ]</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Rentsqm ~ Area'</span>,</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Quantiles'</span>,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Intercepts'</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="st">'Intercepts coefficients for different quantiles'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(rent_qr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Quantile Regression Analysis of Deviance Table

Model: rent ~ area
Joint Test of Equality of Slopes: tau in {  0.1 0.25 0.5 0.75 0.9  }

  Df Resid Df F value    Pr(&gt;F)    
1  4    15406  123.29 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(rentsqm_qr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Quantile Regression Analysis of Deviance Table

Model: rentsqm ~ area
Joint Test of Equality of Slopes: tau in {  0.1 0.25 0.5 0.75 0.9  }

  Df Resid Df F value    Pr(&gt;F)    
1  4    15406  13.975 2.206e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Slopes are significantly different between the quantiles. We can see that the relationships modeled by the different models are uneven and that the median works as a tipping point for both the intercept of the <code>rent ~ area</code> model, reaching a maximum and then decreasing, and for the slope of the <code>rentsqm ~ area</code> model, reaching a minimum and increasing.</p>
<p>We will use bootstrapped coefficients to compute a 95% confidence interval for the slope.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>qr_boot <span class="ot">&lt;-</span> <span class="fu">boot.rq</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">cbind</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    rents_sel<span class="sc">$</span>area</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> rents_sel<span class="sc">$</span>rent,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fl">0.5</span>, </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> <span class="dv">2000</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef =</span> rent_qr_coef</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">apply</span>(qr_boot<span class="sc">$</span>B, <span class="dv">2</span>, quantile, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)))[<span class="dv">2</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    2.5%    97.5% 
3.910982 4.584151 </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>qr_boot <span class="ot">&lt;-</span> <span class="fu">boot.rq</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">cbind</span>(</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    rents_sel<span class="sc">$</span>area</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> rents_sel<span class="sc">$</span>rentsqm,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fl">0.5</span>, </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> <span class="dv">2000</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef =</span> rentsqm_qr_coef</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">apply</span>(qr_boot<span class="sc">$</span>B, <span class="dv">2</span>, quantile, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)))[<span class="dv">2</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       2.5%       97.5% 
-0.04501836 -0.03682849 </code></pre>
</div>
</div>
<p>There is no evidence of either slope being significantly null.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>qs <span class="ot">&lt;-</span> rent_qr <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">expand_grid</span>(</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">area =</span> <span class="fu">seq</span>(</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">20</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">160</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from  =</span>.tau, </span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> .fitted</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">QSC025 =</span> <span class="st">`</span><span class="at">0.75</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.25</span><span class="st">`</span>,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">QSK010 =</span> (<span class="st">`</span><span class="at">0.9</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.5</span><span class="st">`</span>)<span class="sc">/</span>(<span class="st">`</span><span class="at">0.5</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.1</span><span class="st">`</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qs) <span class="sc">+</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>      area, </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>      QSC025</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The spread of the <code>rent</code> distribution is monotonically increasing with the <code>area</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qs) <span class="sc">+</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>      area, </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>      QSK010</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>We can observe that the skewness of the <code>rent</code> distribution is heavily affected by the <code>area</code> variable, changing from left-skewed to symmetric to right-skewed.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>qs <span class="ot">&lt;-</span> rentsqm_qr <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">expand_grid</span>(</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">area =</span> <span class="fu">seq</span>(</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">20</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">160</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from  =</span>.tau, </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> .fitted</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">QSC025 =</span> <span class="st">`</span><span class="at">0.75</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.25</span><span class="st">`</span>,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">QSK010 =</span> (<span class="st">`</span><span class="at">0.9</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.5</span><span class="st">`</span>)<span class="sc">/</span>(<span class="st">`</span><span class="at">0.5</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">0.1</span><span class="st">`</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qs) <span class="sc">+</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>      area, </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>      QSC025</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The spread of <code>rentsqm</code> is slightly decreasing with area.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qs) <span class="sc">+</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>      area, </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>      QSK010</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The right-skewness of the <code>rentsqm</code> variable is exponentially increasing with <code>area</code>: as the area increases, the right-hand tail of the distribution becomes wider; this can be attributed to the surge of outliers in the distribution.</p>
<p>We can definitely conclude that both location, shape and scale of the regressands are affected by the regressor variable.</p>
</section>
<section id="use-the-incomeex-dataset.-what-is-the-effect-of-age-on-income" class="level2">
<h2 class="anchored" data-anchor-id="use-the-incomeex-dataset.-what-is-the-effect-of-age-on-income">Use the <code>incomeEx</code> dataset. What is the effect of Age on Income?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>incomeEx <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pathmaker</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"data/incomeSurvey.csv"</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 10111 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): eth, htype, ced, rural
dbl (6): age, ed, hkids, cinc, lcinc, hid

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>incomeEx<span class="sc">$</span>income <span class="ot">&lt;-</span> incomeEx<span class="sc">$</span>cinc<span class="sc">/</span><span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>incomeEx <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> income</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">2</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"grey20"</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> tau_sel,</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"darkorange"</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Smoothing formula not specified. Using: y ~ x</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The relationship appears to be nonlinear; however, it could be approximated by a linear relationship: <code>income</code> is decreasing with <code>age</code>, although a closer analysis is warranted.</p>
</section>
<section id="is-this-the-same-for-all-quantiles-of-the-distribution" class="level2">
<h2 class="anchored" data-anchor-id="is-this-the-same-for-all-quantiles-of-the-distribution">Is this the same for all quantiles of the distribution?</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>simple_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  income <span class="sc">~</span> age,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> incomeEx,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau =</span> <span class="fu">c</span>(</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">1</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">25</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">5</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">75</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">9</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>simple_fit <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="st">'boot'</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: rq(formula = income ~ age, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = incomeEx)

tau: [1] 0.1

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)  17.50541   0.56353   31.06364   0.00000
age          -0.10558   0.00845  -12.49691   0.00000

Call: rq(formula = income ~ age, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = incomeEx)

tau: [1] 0.25

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)  34.11655   0.99444   34.30721   0.00000
age          -0.22985   0.01518  -15.14014   0.00000

Call: rq(formula = income ~ age, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = incomeEx)

tau: [1] 0.5

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)  56.46243   1.14325   49.38773   0.00000
age          -0.36170   0.02321  -15.58618   0.00000

Call: rq(formula = income ~ age, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = incomeEx)

tau: [1] 0.75

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)  82.61214   1.70254   48.52280   0.00000
age          -0.42045   0.03581  -11.74023   0.00000

Call: rq(formula = income ~ age, tau = c(0.1, 0.25, 0.5, 0.75, 0.9), 
    data = incomeEx)

tau: [1] 0.9

Coefficients:
            Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept) 103.31600   4.24594   24.33287   0.00000
age          -0.21780   0.08642   -2.52015   0.01175</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(simple_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Quantile Regression Analysis of Deviance Table

Model: income ~ age
Joint Test of Equality of Slopes: tau in {  0.1 0.25 0.5 0.75 0.9  }

  Df Resid Df F value    Pr(&gt;F)    
1  4    50551  49.868 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The relationship is indeed different across the quantiles; both intercepts and slopes are changing.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>simple_fit_coeff <span class="ot">&lt;-</span> simple_fit <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span>  <span class="fu">c</span>(</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">1</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">25</span>,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">5</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">75</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">9</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> simple_fit_coeff[<span class="dv">1</span>,]</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Income ~ Area QRM coefficients"</span>,</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Quantiles"</span>,</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Intercept"</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span>  <span class="fu">c</span>(</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">1</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">25</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">5</span>,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">75</span>,</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>        .<span class="dv">9</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> simple_fit_coeff[<span class="dv">2</span>,]</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Income ~ Area QRM coefficients"</span>,</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Quantiles"</span>,</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Slopes"</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="construct-models-in-which-the-relationship-is-allowed-to-be-different-depending-on-the-race-and-education-level-of-the-household-head.-provide-a-graphical-display-that-presents-the-estimated-models.-is-there-enough-evidence-to-indicate-that-the-effect-of-age-on-income-is-different-for-different-raceseducation-levels-specify-the-statistical-test-that-would-be-carried-out." class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="construct-models-in-which-the-relationship-is-allowed-to-be-different-depending-on-the-race-and-education-level-of-the-household-head.-provide-a-graphical-display-that-presents-the-estimated-models.-is-there-enough-evidence-to-indicate-that-the-effect-of-age-on-income-is-different-for-different-raceseducation-levels-specify-the-statistical-test-that-would-be-carried-out.">Construct models in which the relationship is allowed to be different depending on the race and education level of the household head. Provide a graphical display that presents the estimated models. Is there enough evidence to indicate that the effect of Age on Income is different for different races/education levels? Specify the statistical test that would be carried out.</h2>
<p><code>white</code> will be set as the baseline <code>eth</code> for a better interpretation of the coefficients: hence, the average level corresponding to the intercept is <code>college</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and <code>white</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>incomeEx<span class="sc">$</span>eth <span class="ot">&lt;-</span>  incomeEx<span class="sc">$</span>eth <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>incomeEx<span class="sc">$</span>eth <span class="ot">&lt;-</span> <span class="fu">relevel</span>(incomeEx<span class="sc">$</span>eth, <span class="at">ref =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>incomeEx <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> income</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"grey70"</span>,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">7</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> tau_sel,</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">'darkred'</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> <span class="fu">vars</span>(ced),</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">vars</span>(eth)</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Income ~ Age for different Education levels and Ethnicities'</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rq.fit.br(wx, wy, tau = tau, ...): Solution may be nonunique

Warning in rq.fit.br(wx, wy, tau = tau, ...): Solution may be nonunique</code></pre>
</div>
<div class="cell-output-display column-page">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>This set of charts already allows us to spot variations of the response shape and distribution across the quantiles; in particular, there is a noticeable difference between the quantile regressions for <code>white</code> and <code>black</code> for people having attended <code>college</code>. Moreover, we can notice that there are far fewer data points for <code>asian</code>; this might affect the standard errors and hypothesis tests.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>income_extended <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  income <span class="sc">~</span> age <span class="sc">+</span> eth <span class="sc">+</span> ced,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> incomeEx,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> tau_sel</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rq.fit.br(x, y, tau = tau, ...): Solution may be nonunique

Warning in rq.fit.br(x, y, tau = tau, ...): Solution may be nonunique

Warning in rq.fit.br(x, y, tau = tau, ...): Solution may be nonunique</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>income_extended <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="st">'boot'</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: rq(formula = income ~ age + eth + ced, tau = tau_sel, data = incomeEx)

tau: [1] 0.1

Coefficients:
                 Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)       27.58363   0.97464   28.30147   0.00000
age               -0.03180   0.01053   -3.02078   0.00253
ethasian           0.20751   1.62843    0.12743   0.89860
ethblack          -4.31667   0.61888   -6.97492   0.00000
ethhispanic       -1.87367   0.57152   -3.27842   0.00105
cedhighschool    -12.66915   0.82522  -15.35238   0.00000
cedno_highschool -17.19231   0.77566  -22.16466   0.00000
cedsome_college  -10.32890   0.92951  -11.11225   0.00000

Call: rq(formula = income ~ age + eth + ced, tau = tau_sel, data = incomeEx)

tau: [1] 0.25

Coefficients:
                 Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)       45.78011   0.80434   56.91662   0.00000
age               -0.09004   0.01286   -7.00291   0.00000
ethasian           3.55550   2.15451    1.65026   0.09892
ethblack          -6.39611   0.55558  -11.51249   0.00000
ethhispanic       -3.79576   0.74272   -5.11064   0.00000
cedhighschool    -18.12842   0.76481  -23.70320   0.00000
cedno_highschool -26.25053   0.84003  -31.24967   0.00000
cedsome_college  -13.93588   0.91114  -15.29496   0.00000

Call: rq(formula = income ~ age + eth + ced, tau = tau_sel, data = incomeEx)

tau: [1] 0.5

Coefficients:
                 Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)       71.98773   1.49413   48.18034   0.00000
age               -0.14178   0.01745   -8.12569   0.00000
ethasian           2.67363   3.05333    0.87564   0.38124
ethblack         -11.10326   0.73125  -15.18396   0.00000
ethhispanic       -5.80449   1.09142   -5.31830   0.00000
cedhighschool    -27.90703   1.38227  -20.18934   0.00000
cedno_highschool -39.93204   1.39697  -28.58482   0.00000
cedsome_college  -21.65788   1.62671  -13.31389   0.00000

Call: rq(formula = income ~ age + eth + ced, tau = tau_sel, data = incomeEx)

tau: [1] 0.75

Coefficients:
                 Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)      101.68751   2.07195   49.07823   0.00000
age               -0.09859   0.03223   -3.05891   0.00223
ethasian           2.57718   2.81917    0.91416   0.36065
ethblack         -13.41780   1.36897   -9.80136   0.00000
ethhispanic       -4.19079   1.70624   -2.45615   0.01406
cedhighschool    -41.97152   1.88480  -22.26841   0.00000
cedno_highschool -57.73396   2.01364  -28.67141   0.00000
cedsome_college  -32.39420   1.97703  -16.38530   0.00000

Call: rq(formula = income ~ age + eth + ced, tau = tau_sel, data = incomeEx)

tau: [1] 0.9

Coefficients:
                 Value     Std. Error t value   Pr(&gt;|t|) 
(Intercept)      125.01867   2.71144   46.10783   0.00000
age                0.08952   0.04978    1.79826   0.07217
ethasian           3.06928   5.41539    0.56677   0.57088
ethblack         -16.18460   1.84045   -8.79382   0.00000
ethhispanic       -2.01964   2.43936   -0.82794   0.40772
cedhighschool    -54.19444   1.63295  -33.18804   0.00000
cedno_highschool -71.78935   2.17257  -33.04358   0.00000
cedsome_college  -41.25483   2.31105  -17.85111   0.00000</code></pre>
</div>
</div>
<p>A table of the coefficients confirms that both intercept and slope change, with the most noticeable effects on the higher quantiles.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>income_extended <span class="sc">%&gt;%</span> coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    tau= 0.10   tau= 0.25  tau= 0.50    tau= 0.75    tau= 0.90
(Intercept)       27.58362646  45.7801064  71.987735 101.68750905 125.01866719
age               -0.03180311  -0.0900446  -0.141777  -0.09859293   0.08952313
ethasian           0.20751053   3.5555003   2.673634   2.57718092   3.06927531
ethblack          -4.31667147  -6.3961123 -11.103257 -13.41779626 -16.18460328
ethhispanic       -1.87366938  -3.7957588  -5.804488  -4.19079338  -2.01963656
cedhighschool    -12.66914941 -18.1284196 -27.907028 -41.97152467 -54.19444469
cedno_highschool -17.19231250 -26.2505267 -39.932036 -57.73395826 -71.78934969
cedsome_college  -10.32890148 -13.9358760 -21.657876 -32.39420169 -41.25482844</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  income_extended</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Quantile Regression Analysis of Deviance Table

Model: income ~ age + eth + ced
Joint Test of Equality of Slopes: tau in {  0.1 0.25 0.5 0.75 0.9  }

  Df Resid Df F value    Pr(&gt;F)    
1 28    50527  55.414 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>There is strong evidence in favor of the hypothesis that education and ethnicity influence the effect of <code>age</code> on <code>income</code>. Ethnicity at most levels is statistically significant, each pointing at a lower average level; however, the significance is uneven, as in some quantiles, given the reference (baseline) scenario of <code>eth == 'white'</code>, either <code>'asian'</code> or ’<code>hispanic'</code> or both do not seem to have statistical significance, indicating that only the <code>black</code> ethnicity is consistently influencing the effect of <code>age</code> on <code>income</code>, exception made for the lowest decile. Education is consistently significant across all the quantiles, which implies that not graduating from college corresponds to a lower average income, therefore affecting the relationship between <code>income</code> and <code>age</code> as it changes the level of their relationship. We can also notice a strong difference in the slopes.</p>
</section>
</section>
<section id="bootstrap" class="level1">
<h1>Bootstrap</h1>
<section id="for-the-munich-data-compute-confidence-intervals-of-the-mean-rental-price-for-locations-without-central-heating-both-using-theory-and-a-bootstrap-based-approach." class="level2">
<h2 class="anchored" data-anchor-id="for-the-munich-data-compute-confidence-intervals-of-the-mean-rental-price-for-locations-without-central-heating-both-using-theory-and-a-bootstrap-based-approach.">For the Munich data compute confidence intervals of the mean rental price for locations without central heating both using theory and a bootstrap-based approach.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>rents_full <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_table</span>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pathmaker</span>(</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/rent99.raw"</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rent =</span> <span class="fu">col_double</span>(),</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rentsqm =</span> <span class="fu">col_double</span>(),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">col_double</span>(),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">yearc =</span> <span class="fu">col_double</span>(),</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">location =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bath =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">kitchen =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cheating =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">district =</span> <span class="fu">col_factor</span>()</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Method 1:</p>
</blockquote>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>ci_mean <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    rent <span class="sc">~</span> cheating,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> rents_full <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cheating <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">confint</span>()</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>ci_mean[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   2.5 %   97.5 % 
310.5444 344.1638 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Method 2:</p>
</blockquote>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>rents_full <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cheating <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rent =</span> <span class="fu">mean</span>(rent),</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(rent)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> mean_rent <span class="sc">-</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>)<span class="sc">*</span>se,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper  =</span> mean_rent <span class="sc">+</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>)<span class="sc">*</span>se</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">mean_rent</th>
<th style="text-align: right;">se</th>
<th style="text-align: right;">lower</th>
<th style="text-align: right;">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">327.3541</td>
<td style="text-align: right;">8.544081</td>
<td style="text-align: right;">310.608</td>
<td style="text-align: right;">344.1002</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Bootstrap:</p>
</blockquote>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>boot_size <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>bootstrapped_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, boot_size)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>rent_nocheating <span class="ot">&lt;-</span> rents_full <span class="sc">%&gt;%</span> </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>      cheating <span class="sc">==</span> <span class="cn">FALSE</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>      rent</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>boot_size) {</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  bootstrapped_mean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    rent_nocheating<span class="sc">$</span>rent,</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> T</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(bootstrapped_mean, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    2.5%    97.5% 
306.5905 349.7705 </code></pre>
</div>
</div>
<p>For the same significance level of <span class="math inline">5%</span>, the bootstrap method yields a larger interval; nevertheless, it is remarkably similar to the interval computed by applying asymptotic theory.</p>
</section>
<section id="take-the-engel-data.-estimate-a-quantile-regression-model-for-tau-c0.10.50.9.-derive-bootstrap-based-sampling-distributions-for-the-regression-model-parameters.-compare-the-estimated-standard-error-derived-for-your-bootstrap-distribution-to-the-ones-obtained-using-summary-from-the-quantreg-package." class="level2">
<h2 class="anchored" data-anchor-id="take-the-engel-data.-estimate-a-quantile-regression-model-for-tau-c0.10.50.9.-derive-bootstrap-based-sampling-distributions-for-the-regression-model-parameters.-compare-the-estimated-standard-error-derived-for-your-bootstrap-distribution-to-the-ones-obtained-using-summary-from-the-quantreg-package.">Take the <code>engel</code> data. Estimate a quantile regression model for <span class="math inline">\tau = c(0.1,0.5,0.9)</span>. Derive bootstrap-based sampling distributions for the regression model parameters. Compare the estimated standard error derived for your bootstrap distribution to the ones obtained using <code>summary</code> from the <code>quantreg</code> package.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(engel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>engel_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  foodexp <span class="sc">~</span> income, </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> engel</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>engel_fit <span class="sc">%&gt;%</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="st">'boot'</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coefficients</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">select =</span> <span class="st">"Std. Error"</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Std. Error
(Intercept) 26.2429028
income       0.0332872</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>boot_size <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>boot_engel_coeff <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, boot_size, <span class="dv">2</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>boot_size) {</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq</span>(</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>, </span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">nrow</span>(engel)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">nrow</span>(engel)</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>  boot_engel_coeff[i, ] <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    foodexp <span class="sc">~</span> income, </span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> engel[boot_sample, ]</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coefficients</span>() </span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> boot_engel_coeff[, <span class="dv">1</span>],</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Slope =</span> boot_engel_coeff[, <span class="dv">2</span>]</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_intercept =</span> <span class="fu">sd</span>(Intercept),</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Slope =</span> <span class="fu">sd</span>(Slope)</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">SE_intercept</th>
<th style="text-align: right;">SE_Slope</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">28.01705</td>
<td style="text-align: right;">0.0358219</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="take-the-engel-data.-make-a-plot-that-shows-the-point-estimate-and-bootstrap-based-intervals-for-the-slope-of-different-quantile-regression-models-for-values-of-tau-seq0.1-0.9-by-0.05." class="level2">
<h2 class="anchored" data-anchor-id="take-the-engel-data.-make-a-plot-that-shows-the-point-estimate-and-bootstrap-based-intervals-for-the-slope-of-different-quantile-regression-models-for-values-of-tau-seq0.1-0.9-by-0.05.">Take the <code>engel</code> data. Make a plot that shows the point estimate and bootstrap-based intervals for the slope of different quantile regression models for values of <span class="math inline">\tau</span> = <code>seq(0.1, 0.9, by = 0.05)</code>.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>tau_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.1</span>, </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.9</span>, </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fl">0.05</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tau_seq) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'q ='</span>,</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq</span>(</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.1</span>, </span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.9</span>, </span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="fl">0.05</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>engel_mqr <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  foodexp <span class="sc">~</span> income,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> engel,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> tau_seq</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>boot_intervals <span class="ot">&lt;-</span> <span class="cf">function</span>(tau, <span class="at">R =</span> <span class="dv">2000</span>) {</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  qr_boot <span class="ot">&lt;-</span> <span class="fu">boot.rq</span>(</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">cbind</span>(</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>, </span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>      engel<span class="sc">$</span>income</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> engel<span class="sc">$</span>foodexp,</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau =</span> tau, </span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">R =</span> R</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(qr_boot<span class="sc">$</span>B, <span class="dv">2</span>, quantile, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)))[<span class="dv">2</span>, ]</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>engel_slope_ci <span class="ot">&lt;-</span> <span class="fu">lapply</span>(tau_seq, boot_intervals) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>engel_slope_ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">q = 0.1</th>
<th style="text-align: right;">q = 0.15</th>
<th style="text-align: right;">q = 0.2</th>
<th style="text-align: right;">q = 0.25</th>
<th style="text-align: right;">q = 0.3</th>
<th style="text-align: right;">q = 0.35</th>
<th style="text-align: right;">q = 0.4</th>
<th style="text-align: right;">q = 0.45</th>
<th style="text-align: right;">q = 0.5</th>
<th style="text-align: right;">q = 0.55</th>
<th style="text-align: right;">q = 0.6</th>
<th style="text-align: right;">q = 0.65</th>
<th style="text-align: right;">q = 0.7</th>
<th style="text-align: right;">q = 0.75</th>
<th style="text-align: right;">q = 0.8</th>
<th style="text-align: right;">q = 0.85</th>
<th style="text-align: right;">q = 0.9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.3360180</td>
<td style="text-align: right;">0.3326290</td>
<td style="text-align: right;">0.3477040</td>
<td style="text-align: right;">0.3808307</td>
<td style="text-align: right;">0.4105921</td>
<td style="text-align: right;">0.4479016</td>
<td style="text-align: right;">0.4598879</td>
<td style="text-align: right;">0.4634948</td>
<td style="text-align: right;">0.4691703</td>
<td style="text-align: right;">0.4990268</td>
<td style="text-align: right;">0.5326032</td>
<td style="text-align: right;">0.5408653</td>
<td style="text-align: right;">0.5551454</td>
<td style="text-align: right;">0.5706885</td>
<td style="text-align: right;">0.593088</td>
<td style="text-align: right;">0.6175840</td>
<td style="text-align: right;">0.6315805</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4840377</td>
<td style="text-align: right;">0.5014831</td>
<td style="text-align: right;">0.5081901</td>
<td style="text-align: right;">0.5153115</td>
<td style="text-align: right;">0.5428585</td>
<td style="text-align: right;">0.5662009</td>
<td style="text-align: right;">0.5882284</td>
<td style="text-align: right;">0.6031955</td>
<td style="text-align: right;">0.6111211</td>
<td style="text-align: right;">0.6238026</td>
<td style="text-align: right;">0.6391112</td>
<td style="text-align: right;">0.6699172</td>
<td style="text-align: right;">0.6782821</td>
<td style="text-align: right;">0.6989063</td>
<td style="text-align: right;">0.707444</td>
<td style="text-align: right;">0.7126024</td>
<td style="text-align: right;">0.7333385</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tau_seq <span class="sc">%&gt;%</span> as_tibble,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> tau_seq,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> engel_mqr<span class="sc">$</span>coefficients[<span class="dv">2</span>,]</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"grey60"</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> engel_slope_ci[<span class="dv">1</span>, ] <span class="sc">%&gt;%</span> <span class="fu">t</span>(),</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> engel_slope_ci[<span class="dv">2</span>,] <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Slope confidence intervals for Engel data"</span>,</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(tau),</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)<span class="sc">^</span>(tau))</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="BA-Exercises_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>For the <code>ced</code> variable.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>